#–ù–∞–ø–∏—à–∏—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º—É –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Å–æ–±–∏—Ä–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –æ –∫–ª–∏–µ–Ω—Ç–∞—Ö –±–∞–Ω–∫–∞ –∫—Ä–æ–≤–∏. 
# –ß–µ–ª–æ–≤–µ–∫ –º–æ–∂–µ—Ç —Å–¥–∞–≤–∞—Ç—å –∫—Ä–æ–≤—å –Ω–µ —á–∞—â–µ —á–µ–º —Ä–∞–∑ –≤ –º–µ—Å—è—Ü, –∏ –Ω–µ –º–æ–∂–µ—Ç –∏–º–µ—Ç—å –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è, –∏ –±—ã—Ç—å —Å—Ç–∞—Ä—à–µ 65 –ª–µ—Ç –∏ –º–ª–∞–¥—à–µ 12.
#1) –î–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞.
#   –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–æ: 
#   –§–ò, –∫–æ–ª. –ø–æ–ª–Ω—ã—Ö –ª–µ—Ç, –≥—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏, —Ä–µ–∑—É—Å —Ñ–∞–∫—Ç–æ—Ä, –Ω–∞–ª–∏—á–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π, –∫–æ–ª. –¥–Ω–µ–π —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–¥–∞—á–∏ –∫—Ä–æ–≤–∏.
#2) –ü—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞—è–≤–∫—É –Ω–∞ —Å–¥–∞—á—É –∫—Ä–æ–≤–∏
#3) –†–∞—Å–ø—Ä–µ–¥–µ–ª—è—Ç—å –∫–ª–∏–µ–Ω—Ç–æ–≤ –¥–æ–±–∞–≤–ª—è—è –≤ blacklist –∏–ª–∏ reglist.
#4) –û—Ç–æ–±—Ä–∞–∂–∞—Ç—å –∑–∞–ø—Ä–æ—Å –Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞.
#5) –í–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ –∫–ª–∏–µ–Ω—Ç–∞–º.
#6) –í—ã–≤–æ–¥–∏—Ç—å blacklist, —Å–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö, –∏ —Å–ø–∏—Å–æ–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π.

reglist = {1: {'–§–ò:': '–ú–∏—à–∏–Ω –ò–≥–æ—Ä—å', '–í–æ–∑—Ä–∞—Å—Ç:': 32, '–ì—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏:': 3, '–†–µ–∑—É—Å —Ñ–∞–∫—Ç–æ—Ä:': '+', "–ö—Ä–∞–π–Ω–∏–π –∑–∞–±–æ—Ä –∫—Ä–æ–≤–∏:": 19,'–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:': ['–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π']},
           2: {'–§–ò:': "–°–µ—Ä–≥–µ–π –ú–∞–Ω–∂–æ—Å–æ–≤", "–í–æ–∑—Ä–∞—Å—Ç:": 16, "–ì—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏:": 2, "–†–µ–∑—É—Å —Ñ–∞–∫—Ç–æ—Ä:": "+", "–ö—Ä–∞–π–Ω–∏–π –∑–∞–±–æ—Ä –∫—Ä–æ–≤–∏:": -1,"–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:": ['–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π']},
           3: {'–§–ò:': '–ï–≥–æ—Ä–æ–≤–∞ –ò—Ä–∏–Ω–∞', '–í–æ–∑—Ä–∞—Å—Ç:': 15, '–ì—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏:': 1, '–†–µ–∑—É—Å —Ñ–∞–∫—Ç–æ—Ä:': '+', '–ö—Ä–∞–π–Ω–∏–π –∑–∞–±–æ—Ä –∫—Ä–æ–≤–∏:': -1, '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:': ['–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π']},
           4: {'–§–ò:': '–í–ª–∞–¥–∏—Å–ª–∞–≤ –ï–Ω–∏–∫–µ–µ–≤', '–í–æ–∑—Ä–∞—Å—Ç:': 15, '–ì—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏:': 2, '–†–µ–∑—É—Å —Ñ–∞–∫—Ç–æ—Ä:': '-', '–ö—Ä–∞–π–Ω–∏–π –∑–∞–±–æ—Ä –∫—Ä–æ–≤–∏:': 35, '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:': ['–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π']}}
blacklist = {1: {'–§–ò:': '–¢—Ä–æ—Ñ–∏–º–æ–≤ –í–ª–∞–¥–∏–º–∏—Ä', '–í–æ–∑—Ä–∞—Å—Ç:': 66, '–ì—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏:': 3, '–†–µ–∑—É—Å —Ñ–∞–∫—Ç–æ—Ä:': '+', 
                 "–ü–æ—Å–ª–µ–¥–Ω—è—è —Å–¥–∞—á–∞ –∫—Ä–æ–≤–∏:": '75','–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:': ['–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π']}}
ogranichen = ['–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π','–ì–µ–ø–∞—Ç–∏—Ç –ê', "–ì–µ–ø–∞—Ç–∏—Ç –ë", "–°–ø–∏–¥"]

def inzapros():
    spisok = ['1 - –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è', "2 - –ó–∞—è–≤–∫–∞ –Ω–∞ —Å–¥–∞—á—É –∫—Ä–æ–≤–∏", 
              "3 - –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π", "4 - –í—ã–≤–µ—Å—Ç–∏ —Å–ø–∏—Å–æ–∫ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö", 
              "5 - –í—ã–≤–µ—Å—Ç–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —á–µ–ª–æ–≤–µ–∫–µ", "6 - –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∞–Ω–∫–µ—Ç—É"]
    for i in spisok:
        print(i)

def reg():
    global ogranichen
    chelovek = {
        "–§–ò:": input('–í–≤–µ–¥–∏—Ç–µ –§–ò: '),
        "–í–æ–∑—Ä–∞—Å—Ç:": int(input('–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª. –ø–æ–ª–Ω—ã—Ö –ª–µ—Ç: ')),
        "–ì—Ä—É–ø–ø–∞ –∫—Ä–æ–≤–∏": int(input('–í–≤–µ–¥–∏—Ç–µ –≥—Ä—É–ø–ø—É –∫—Ä–æ–≤–∏: ')),
        "–†–µ–∑—É—Å —Ñ–∞–∫—Ç–æ—Ä": input('–í–≤–µ–¥–∏—Ç–µ + –∏–ª–∏ - –¥–ª—è —Ä–µ–∑—É—Å —Ñ–∞–∫—Ç–æ—Ä–∞: '),
        "–ö—Ä–∞–π–Ω–∏–π –∑–∞–±–æ—Ä –∫—Ä–æ–≤–∏:": int(input('–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª. –¥–Ω–µ–π —Å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–±–æ—Ä–∞ –∫—Ä–æ–≤–∏(–µ—Å–ª–∏ –≤—ã –Ω–µ —Å–¥–∞–≤–∞–ª–∏ –∫—Ä–æ–≤—å, –≤–≤–µ–¥–∏—Ç–µ -1): '))
    }
    chelovek['–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:'] = []
    for i in range(1,len(ogranichen)):
        print(f'üç∞ {i} - {ogranichen[i]}')
    otvet = input('–í–≤–µ–¥–∏—Ç–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª –Ω–æ–º–µ—Ä–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π(–µ—Å–ª–∏ —É –≤–∞—Å –∏—Ö –Ω–µ—Ç, –≤–≤–µ–¥–∏—Ç–µ 0): ').split()
    for i in otvet:
        chelovek['–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:'].append(ogranichen[int(i)])
    distrib(chelovek)

def outinfo(spisok):
    for id, chelovek in spisok.items(): # (1, {–§–ò: –ú–∏—à–∏–Ω –ò–≥–æ—Ä—å ....}), (2, {–§–ò: –ü—Ä–∏–¥—É–º–∫–∏–Ω –•–∞—à–∏—Ä–∞–º ...})
        print(f'id{id}: ', end='')
        for key,value in chelovek.items():
            if key == '–í–æ–∑—Ä–∞—Å—Ç:':
                print(f'{key} {sufics(value)}', end=';')
            elif key == '–ö—Ä–∞–π–Ω–∏–π –∑–∞–±–æ—Ä –∫—Ä–æ–≤–∏:' and value < 0:
                print(f'{key} –∑–∞–±–æ—Ä–∞ –∫—Ä–æ–≤–∏ –Ω–µ–±—ã–ª–æ', end=';')
            else:
                print(f'{key} {value}', end=';')
        print()

def sufics(age):
    if age % 10 >= 5 or age % 10 == 0 or 10<age%100<15:#–ø—Ä–æ–ø–∏—à–µ–º —É—Å–ª–æ–≤–∏–µ –¥–ª—è "–ª–µ—Ç"
        return str(age)+' –ª–µ—Ç'
    elif age%10>1:#–ø—Ä–æ–ø–∏—à–µ–º —É—Å–ª–æ–≤–∏–µ –¥–ª—è "–≥–æ–¥–∞"
        return str(age)+' –≥–æ–¥–∞'
    else:
        return str(age)+' –≥–æ–¥'

def distrib(chelovek):
    global reglist, blacklist
    flag = True
    for i in chelovek['–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:']:
        if i in ogranichen[1:]:
            flag = False
            break
    if chelovek['–í–æ–∑—Ä–∞—Å—Ç:']>65 or chelovek['–í–æ–∑—Ä–∞—Å—Ç:']<12 or flag == False:
        blacklist[len(blacklist.keys())+1] = chelovek
    else:
        reglist[len(reglist.keys())+1] = chelovek

def application(name):
    flagreg = False
    for id,chelovek in reglist.items():
        if name in chelovek.values():
            flagreg = True
            if int(chelovek["–ö—Ä–∞–π–Ω–∏–π –∑–∞–±–æ—Ä –∫—Ä–æ–≤–∏:"])>30 or int(chelovek["–ö—Ä–∞–π–Ω–∏–π –∑–∞–±–æ—Ä –∫—Ä–æ–≤–∏:"])<0:
                print('–í—ã –º–æ–∂–µ—Ç–µ —Å–¥–∞—Ç—å –∫—Ä–æ–≤—å –∏ –≤–∑—è—Ç—å —Ö–ª–µ–±–∞ —Å –º—è—Å–æ–º üçî')
            else:
                print(f'–í—ã —É–∂–µ —Å–¥–∞–≤–∞–ª–∏ –∫—Ä–æ–≤—å, –∏ –≤–∞–º –Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å {30-int(chelovek["–ö—Ä–∞–π–Ω–∏–π –∑–∞–±–æ—Ä –∫—Ä–æ–≤–∏:"])} –¥–Ω–µ–π üåπ')
            break
    else:
        for id,chelovek in blacklist.items():
            if name in chelovek.values():
                flagreg = True
                print(f'–ö —Å–æ–∂–∞–ª–µ–Ω–∏—é –≤—ã –Ω–µ –º–æ–∂–µ—Ç–µ —Å–¥–∞–≤–∞—Ç—å –∫—Ä–æ–≤—å –∏–∑ –∑–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤–æ–∑—Ä–∞—Å—Ç–∞ –∏–ª–∏ –±–æ–ª–µ–∑–Ω–∏ ‚≠êÔ∏è')
                break
    if flagreg == False:
        print('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–π—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é! üëß')

def nameinfo(name):
    flagreg = False
    for id,chelovek in reglist.items():
        if name in chelovek.values():
            flagreg = True
            key = id
            mylist = reglist
            break
    else:
        for id,chelovek in blacklist.items():
            if name in chelovek.values():
                flagreg = True
                key = id
                mylist = blacklist
                break
    if flagreg == False:
        print('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–π—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é! üëß')
    else:
        print(f'–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –∞–Ω–∫–µ—Ç–µ: {mylist[id]}')

def edit(name):
    flagreg = False
    for id,chelovek in reglist.items():
        if name in chelovek.values():
            flagreg = True
            key = id
            mylist = reglist
            break
    else:
        for id,chelovek in blacklist.items():
            if name in chelovek.values():
                flagreg = True
                key = id
                mylist = blacklist
                break
    if flagreg == False:
        print('–ù–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–æ–π—Ç–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é! üëß')
    else:
        print(f'–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –∞–Ω–∫–µ—Ç–µ: {mylist[id]}')
        while True:
            key = input('–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–æ–ª—è: ')
            if key == '–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è':
                for i in range(1,len(ogranichen)):
                    print(f'üç∞ {i} - {ogranichen[i]}')
                otvet = input('–í–≤–µ–¥–∏—Ç–µ —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª –Ω–æ–º–µ—Ä–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π(–µ—Å–ª–∏ —É –≤–∞—Å –∏—Ö –Ω–µ—Ç, –≤–≤–µ–¥–∏—Ç–µ 0): ').split()
                for i in otvet:
                    mylist[id]['–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:'].append(ogranichen[int(i)])
                zapros = input('–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–≤–µ–¥–∏—Ç–µ +:')
                if zapros != '+':
                    break
                else:
                    continue
            value = input('–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è: ')
            mylist[id][key+':'] = value
            zapros = input('–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –ø—Ä–æ–¥–æ–ª–∂–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–≤–µ–¥–∏—Ç–µ +:')
            if zapros != '+':
                break
        #–ü—Ä–æ–ø–∏—Å–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –¥—Ä—É–≥–æ–π —Å–ø–∏—Å–æ–∫.
while True:
    inzapros()
    zapros = input('–í–≤–µ–¥–∏—Ç–µ –Ω–æ–º–µ—Ä –ø—É–Ω–∫—Ç–∞: ')
    if zapros == '0':
        break
    elif zapros == '1':
        reg()
    elif zapros == '2':
        application(input('–í–≤–µ–¥–∏—Ç–µ –∏–º—è: '))
    elif zapros == '4':
        print('reglist: ')
        outinfo(reglist)
        print('blacklist: ')
        outinfo(blacklist)
    elif zapros == '5':
        nameinfo(input('–í–≤–µ–¥–∏—Ç–µ –§–ò: '))
    elif zapros == '6':
        edit(input('–í–≤–µ–¥–∏—Ç–µ –§–ò: '))